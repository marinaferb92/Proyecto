---
- name: Importar SQL inicial
  hosts: "{{ db_primary_host }}"
  become: yes
  vars_files:
    - ../vars/variables.yml

  tasks:

    - name: Copiar SQL al servidor
      copy:
        src: "../{{ sql_dir }}/{{ item }}"
        dest: "/tmp/{{ item }}"
        mode: "0644"
      loop:
        - clinica_estructura.sql
        - clinica_datos_base.sql
        - clinica_datos_demo.sql

    - name: Importar estructura (tablas, FKs, triggers, vistas, etc.)
      community.mysql.mysql_db:
        name: "{{ db_name }}"
        state: import
        target: "/tmp/clinica_estructura.sql"
        login_user: root
        login_password: "{{ db_root_password }}"

    - name: Importar datos base (cat√°logos, etc.)
      community.mysql.mysql_db:
        name: "{{ db_name }}"
        state: import
        target: "/tmp/clinica_datos_base.sql"
        login_user: root
        login_password: "{{ db_root_password }}"

    - name: Importar datos demo (clientes, citas, etc.)
      community.mysql.mysql_db:
        name: "{{ db_name }}"
        state: import
        target: "/tmp/clinica_datos_demo.sql"
        login_user: root
        login_password: "{{ db_root_password }}"
