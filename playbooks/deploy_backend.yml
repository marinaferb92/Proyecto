- hosts: backend
  become: yes
  vars_files:
    - ../vars/variables.yml

  tasks:
    - name: Crear carpeta temporal para SQL
      file:
        path: /tmp/sql_clinica
        state: directory
        mode: "0755"

    - name: Copiar estructura SQL al backend
      copy:
        src: "../sql/clinica_estructura.sql"
        dest: "/tmp/sql_clinica/clinica_estructura.sql"

    - name: Copiar datos base SQL al backend
      copy:
        src: "../sql/clinica_datos_base.sql"
        dest: "/tmp/sql_clinica/clinica_datos_base.sql"

    - name: Copiar datos demo SQL al backend
      copy:
        src: "../sql/clinica_datos_demo.sql"
        dest: "/tmp/sql_clinica/clinica_datos_demo.sql"

    - name: Importar estructura clÃ­nica
      command: >
        bash -c "mysql -u root -p{{ db.root_password }} {{ db.name }} < /tmp/sql_clinica/clinica_estructura.sql"

    - name: Importar datos base
      command: >
        bash -c "mysql -u root -p{{ db.root_password }} {{ db.name }} < /tmp/sql_clinica/clinica_datos_base.sql"

    - name: Importar datos demo (procedimiento)
      command: >
        bash -c "mysql -u root -p{{ db.root_password }} {{ db.name }} < /tmp/sql_clinica/clinica_datos_demo.sql"
