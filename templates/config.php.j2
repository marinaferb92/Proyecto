<?php
require_once '/var/www/html/session_handler.php';

$DB_HOST = "{{ ip.backend1 }}";
$DB_NAME = "{{ db.name }}";
$DB_USER = "{{ db.user }}";
$DB_PASS = "{{ db.password }}";

try {
    $pdo = new PDO(
        "mysql:host=$DB_HOST;dbname=$DB_NAME;charset=utf8mb4",
        $DB_USER,
        $DB_PASS,
        [
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
        ]
    );
} catch (PDOException $e) {
    die("Error de conexiÃ³n: " . $e->getMessage());
}

// Usar el MySQLSessionHandler
session_set_save_handler(
    new MySQLSessionHandler(
        '{{ ip.backend1 }}',
        '{{ db.name }}',
        '{{ db.user }}',
        '{{ db.password }}'
    ),
    true
);

session_start();
?>
